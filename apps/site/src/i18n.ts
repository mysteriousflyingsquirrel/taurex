const translations: Record<string, Record<string, string>> = {
  en: {
    "nav.backToHome": "Back to Home",
    "filter.dateRange": "Dates",
    "filter.dates": "Dates",
    "filter.checkIn": "Check-in",
    "filter.checkOut": "Check-out",
    "filter.guests": "Guests",
    "filter.onlyAvailable": "Show only available",
    "filter.reset": "Reset",
    "apartments.title": "Our Apartments",
    "apartments.empty": "No apartments available.",
    "apartments.emptyFiltered": "No apartments match your filter.",
    "apartment.perNight": "/ night",
    "apartment.guests": "Guests",
    "apartment.bedrooms": "Bedrooms",
    "apartment.doubleBeds": "Double beds",
    "apartment.singleBeds": "Single beds",
    "apartment.bathrooms": "Bathrooms",
    "apartment.sqm": "m²",
    "apartment.description": "Description",
    "apartment.amenities": "Amenities",
    "apartment.location": "Location",
    "apartment.facts": "Facts",
    "apartment.bookingLinks": "Book this apartment",
    "apartment.directBooking": "Booking Request",
    "apartment.minStay": "Minimum stay: {nights} nights",
    "apartment.moreApartments": "More apartments",
    "apartment.noImages": "No images available",
    "apartment.availability": "Availability",
    "apartment.availabilityComingSoon": "Coming soon...",
    "apartment.booking": "Booking",
    "apartment.selectDatesFirst": "Please select your dates on the apartment listing page to see pricing.",
    "apartment.selectedDates": "Selected dates",
    "apartment.bestPriceTitle": "Best price guaranteed!",
    "apartment.bestPriceDesc": "Book directly through our booking request and get the cheapest price available.",
    "apartment.nightsSelected": "{nights} nights selected",
    "apartment.approxTotal": "Approx. total: {currency} {total}",
    "apartment.approxDisclaimer": "Approximate estimate. Final price at the discretion of the host.",
    "notFound.tenant": "Tenant not found",
    "notFound.apartment": "Apartment not found",
    "notFound.backToTenant": "Back to apartments",
    "notFound.backToHome": "Back to Taurex",
  },
  de: {
    "nav.backToHome": "Zurück zur Startseite",
    "filter.dateRange": "Reisedaten",
    "filter.dates": "Daten",
    "filter.checkIn": "Anreise",
    "filter.checkOut": "Abreise",
    "filter.guests": "Gäste",
    "filter.onlyAvailable": "Nur verfügbare anzeigen",
    "filter.reset": "Zurücksetzen",
    "apartments.title": "Unsere Apartments",
    "apartments.empty": "Keine Apartments verfügbar.",
    "apartments.emptyFiltered": "Keine Apartments für Ihre Auswahl gefunden.",
    "apartment.perNight": "/ Nacht",
    "apartment.guests": "Gäste",
    "apartment.bedrooms": "Schlafzimmer",
    "apartment.doubleBeds": "Doppelbetten",
    "apartment.singleBeds": "Einzelbetten",
    "apartment.bathrooms": "Badezimmer",
    "apartment.sqm": "m²",
    "apartment.description": "Beschreibung",
    "apartment.amenities": "Ausstattung",
    "apartment.location": "Standort",
    "apartment.facts": "Fakten",
    "apartment.bookingLinks": "Dieses Apartment buchen",
    "apartment.directBooking": "Buchungsanfrage",
    "apartment.minStay": "Mindestaufenthalt: {nights} Nächte",
    "apartment.moreApartments": "Weitere Apartments",
    "apartment.noImages": "Keine Bilder verfügbar",
    "apartment.availability": "Verfügbarkeit",
    "apartment.availabilityComingSoon": "Demnächst verfügbar...",
    "apartment.booking": "Buchung",
    "apartment.selectDatesFirst": "Bitte wählen Sie Ihre Daten auf der Apartmentübersicht, um Preise zu sehen.",
    "apartment.selectedDates": "Ausgewählte Daten",
    "apartment.bestPriceTitle": "Bestpreis garantiert!",
    "apartment.bestPriceDesc": "Buchen Sie direkt über unsere Buchungsanfrage und erhalten Sie den günstigsten Preis.",
    "apartment.nightsSelected": "{nights} Nächte ausgewählt",
    "apartment.approxTotal": "Ca. Gesamtpreis: {currency} {total}",
    "apartment.approxDisclaimer": "Ungefähre Schätzung. Endpreis nach Ermessen des Gastgebers.",
    "notFound.tenant": "Vermieter nicht gefunden",
    "notFound.apartment": "Apartment nicht gefunden",
    "notFound.backToTenant": "Zurück zu den Apartments",
    "notFound.backToHome": "Zurück zu Taurex",
  },
  fr: {
    "nav.backToHome": "Retour à l'accueil",
    "filter.dateRange": "Dates de séjour",
    "filter.dates": "Dates",
    "filter.checkIn": "Arrivée",
    "filter.checkOut": "Départ",
    "filter.guests": "Voyageurs",
    "filter.onlyAvailable": "Afficher uniquement les disponibles",
    "filter.reset": "Réinitialiser",
    "apartments.title": "Nos appartements",
    "apartments.empty": "Aucun appartement disponible.",
    "apartments.emptyFiltered": "Aucun appartement ne correspond à votre filtre.",
    "apartment.perNight": "/ nuit",
    "apartment.guests": "Voyageurs",
    "apartment.bedrooms": "Chambres",
    "apartment.doubleBeds": "Lits doubles",
    "apartment.singleBeds": "Lits simples",
    "apartment.bathrooms": "Salles de bain",
    "apartment.sqm": "m²",
    "apartment.description": "Description",
    "apartment.amenities": "Équipements",
    "apartment.location": "Emplacement",
    "apartment.facts": "Caractéristiques",
    "apartment.bookingLinks": "Réserver cet appartement",
    "apartment.directBooking": "Demande de réservation",
    "apartment.minStay": "Séjour minimum : {nights} nuits",
    "apartment.moreApartments": "Plus d'appartements",
    "apartment.noImages": "Aucune image disponible",
    "apartment.availability": "Disponibilité",
    "apartment.availabilityComingSoon": "Bientôt disponible...",
    "apartment.booking": "Réservation",
    "apartment.selectDatesFirst": "Veuillez sélectionner vos dates sur la page de liste pour voir les prix.",
    "apartment.selectedDates": "Dates sélectionnées",
    "apartment.bestPriceTitle": "Meilleur prix garanti !",
    "apartment.bestPriceDesc": "Réservez directement via notre demande de réservation et obtenez le prix le plus avantageux.",
    "apartment.nightsSelected": "{nights} nuits sélectionnées",
    "apartment.approxTotal": "Total approx. : {currency} {total}",
    "apartment.approxDisclaimer": "Estimation approximative. Le prix final est à la discrétion de l'hôte.",
    "notFound.tenant": "Propriétaire introuvable",
    "notFound.apartment": "Appartement introuvable",
    "notFound.backToTenant": "Retour aux appartements",
    "notFound.backToHome": "Retour à Taurex",
  },
  it: {
    "nav.backToHome": "Torna alla home",
    "filter.dateRange": "Date di soggiorno",
    "filter.dates": "Date",
    "filter.checkIn": "Check-in",
    "filter.checkOut": "Check-out",
    "filter.guests": "Ospiti",
    "filter.onlyAvailable": "Mostra solo disponibili",
    "filter.reset": "Reimposta",
    "apartments.title": "I nostri appartamenti",
    "apartments.empty": "Nessun appartamento disponibile.",
    "apartments.emptyFiltered": "Nessun appartamento corrisponde al filtro.",
    "apartment.perNight": "/ notte",
    "apartment.guests": "Ospiti",
    "apartment.bedrooms": "Camere",
    "apartment.doubleBeds": "Letti matrimoniali",
    "apartment.singleBeds": "Letti singoli",
    "apartment.bathrooms": "Bagni",
    "apartment.sqm": "m²",
    "apartment.description": "Descrizione",
    "apartment.amenities": "Dotazioni",
    "apartment.location": "Posizione",
    "apartment.facts": "Caratteristiche",
    "apartment.bookingLinks": "Prenota questo appartamento",
    "apartment.directBooking": "Richiesta di prenotazione",
    "apartment.minStay": "Soggiorno minimo: {nights} notti",
    "apartment.moreApartments": "Altri appartamenti",
    "apartment.noImages": "Nessuna immagine disponibile",
    "apartment.availability": "Disponibilità",
    "apartment.availabilityComingSoon": "Prossimamente...",
    "apartment.booking": "Prenotazione",
    "apartment.selectDatesFirst": "Seleziona le date nella pagina degli appartamenti per vedere i prezzi.",
    "apartment.selectedDates": "Date selezionate",
    "apartment.bestPriceTitle": "Miglior prezzo garantito!",
    "apartment.bestPriceDesc": "Prenota direttamente tramite la nostra richiesta di prenotazione e ottieni il prezzo più conveniente.",
    "apartment.nightsSelected": "{nights} notti selezionate",
    "apartment.approxTotal": "Totale appross.: {currency} {total}",
    "apartment.approxDisclaimer": "Stima approssimativa. Il prezzo finale è a discrezione dell'host.",
    "notFound.tenant": "Proprietario non trovato",
    "notFound.apartment": "Appartamento non trovato",
    "notFound.backToTenant": "Torna agli appartamenti",
    "notFound.backToHome": "Torna a Taurex",
  },
};

export function t(lang: string, key: string, params?: Record<string, string | number>): string {
  const str = translations[lang]?.[key] ?? translations.en[key] ?? key;
  if (!params) return str;
  return Object.entries(params).reduce(
    (acc, [k, v]) => acc.replace(`{${k}}`, String(v)),
    str
  );
}

export function useLang(searchParams: URLSearchParams, tenantLanguages: string[]): string {
  const langParam = searchParams.get("lang");
  if (langParam && tenantLanguages.includes(langParam)) return langParam;
  return tenantLanguages[0] ?? "en";
}

/** Build a search params string preserving existing params but setting/overriding given ones */
export function buildSearch(
  current: URLSearchParams,
  overrides: Record<string, string>
): string {
  const params = new URLSearchParams(current);
  for (const [k, v] of Object.entries(overrides)) {
    params.set(k, v);
  }
  return params.toString();
}

export const currencySymbol: Record<string, string> = {
  CHF: "CHF",
  EUR: "€",
  USD: "$",
  GBP: "£",
};

/** Format a YYYY-MM-DD date string as dd.mm.yyyy */
export function formatDate(dateStr: string): string {
  if (!dateStr) return "";
  const parts = dateStr.split("-");
  if (parts.length !== 3) return dateStr;
  const [y, m, d] = parts;
  return `${d}.${m}.${y}`;
}
